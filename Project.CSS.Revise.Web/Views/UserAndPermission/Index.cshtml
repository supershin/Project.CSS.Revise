@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutSite.cshtml";
    var departments = ViewBag.listDepartments as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var roles = ViewBag.listRoles as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var buList = ViewBag.listBu as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
}
<div class="container-fluid">
    <div class="page-title">
        <div class="row">
            <div class="col-6">
                <h4>User & Permission</h4>
            </div>
            <div class="col-6">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a>
                            <svg class="stroke-icon">
                                <use xlink:href="@Url.Content("~/assets/svg/icon-sprite.svg#stroke-home")"></use>
                            </svg>
                        </a>
                    </li>
                    <li class="breadcrumb-item">Pages</li>
                    <li class="breadcrumb-item active">User & Permission</li>
                </ol>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <ul class="simple-wrapper nav nav-tabs" id="User-Permission-Tab-filter" role="tablist">
                    <li class="nav-item"><a class="nav-link active txt-primary" id="user-tab" data-bs-toggle="tab" href="#user-filter" role="tab" aria-controls="user-tab" aria-selected="true"><i class="fa fa-user" aria-hidden="true"></i>User</a></li>
                    <li class="nav-item"><a class="nav-link txt-primary" id="permission-tab" data-bs-toggle="tab" href="#permission-filter" role="tab" aria-controls="permission-tab" aria-selected="false"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>Permission</a></li>
                </ul>
                <div class="tab-content" id="User-Permission-Tab-filter-Content">
                    <div class="tab-pane fade  show active" id="user-filter" role="tabpanel" aria-labelledby="user-tab">
                        <div class="card-header d-flex flex-wrap justify-content-between align-items-center gap-2">
                            <form id="userFilterForm" class="w-100">
                                <div class="d-flex flex-wrap align-items-end gap-2 w-100">

                                    <!-- Name search: กินพื้นที่เยอะสุด, เต็มแถวบนมือถือ -->
                                    <div class="flex-fill minw-240 flex-basis-40 mb-2">
                                        <label for="txtSearchName" class="form-label mb-1">ค้นหาชื่อ</label>
                                        <input type="text"
                                               id="txtSearchName"
                                               class="form-control form-control-lg"
                                               placeholder="🔍 พิมพ์ชื่อไทย/อังกฤษ หรือชื่อเต็ม เช่น 'สมชาย' หรือ 'John Doe'">
                                    </div>

                                    <!-- Department: ขนาดกลาง -->
                                    <div class="minw-220 flex-basis-25 mb-2">
                                        <label for="ddlDepartment" class="form-label mb-1">Department</label>
                                        <select id="ddlDepartment" class="form-select" multiple>
                                            @foreach (var d in departments)
                                            {
                                                var val = (d.ValueInt ?? d.Value ?? d.ID ?? "").ToString();
                                                var text = (d.Text ?? d.Name ?? d.Display ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>

                                    <!-- Role: ขนาดกลาง -->
                                    <div class="minw-220 flex-basis-25 mb-2">
                                        <label for="ddlRole" class="form-label mb-1">Role</label>
                                        <select id="ddlRole" class="form-select" multiple>
                                            @foreach (var r in roles)
                                            {
                                                var val = (r.ValueInt ?? r.Value ?? r.ID ?? "").ToString();
                                                var text = (r.Text ?? r.Name ?? r.Display ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>

                                    <div class="ms-auto mb-2">
                                        <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#modalCreateUser">
                                            <i class="fa fa-user-plus me-1"></i>
                                        </button>
                                    </div>

                                    <!-- Search button: ชิดขวาเมื่อจอใหญ่, เต็มแถวเมื่อจอเล็ก -->
                                    <div class="ms-auto mb-2">
                                        <button type="button" id="btnSearchUser" class="btn btn-outline-secondary btn-lg">
                                            <i class="fa fa-search me-1"></i> Search
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="card-body">
                            <div class="row list-users" id="list-users-card-body">
                                <div class="col-xl-4 xl-40 col-md-5">
                                    <div class="vertical-scroll scroll-demo scroll-b-none"
                                         style="height: 1213px; overflow-y: auto; overflow-x: hidden;">
                                         <div id="userList" class="list-group">
                                         </div>
                                    </div>
                                </div>
                                <div class="col-xl-8 xl-60 col-md-7">
                                    <div class="card h-100">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h4 class="mb-0" id="user_name_show">กิติยา กัญยะโสภา</h4>
                                            <button type="button" class="btn btn-outline-danger btn-sm">
                                                <i class="bi bi-trash"></i> Delete
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <ul class="nav nav-tabs border-tab mb-0" id="bottom-tab" role="tablist">
                                                <li class="nav-item"><a class="nav-link nav-border txt-info tab-info active" id="bottom-home-tab" data-bs-toggle="tab" href="#bottom-home" role="tab" aria-controls="bottom-home" aria-selected="true"><i class="icofont icofont-ui-user"></i>Detail</a></li>
                                                <li class="nav-item"><a class="nav-link nav-border txt-info tab-info " id="bottom-inbox-tab" data-bs-toggle="tab" href="#bottom-inbox" role="tab" aria-controls="bottom-inbox" aria-selected="false"><i class="icofont icofont-building-alt"></i>Project & BU</a></li>
                                            </ul>
                                            <div class="tab-content" id="bottom-tabContent">
                                                <div class="tab-pane fade show active" id="bottom-home" role="tabpanel" aria-labelledby="bottom-home-tab">
                                                    <form class="form theme-form" id="edit_user">
                                                        <div class="card-body custom-input">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">
                                                                            Title <span class="text-danger">*</span>
                                                                        </label>
                                                                        <div class="col-sm-9">
                                                                            <select class="form-select btn-square digits" id="ddl_Title_edit">
                                                                                <option value=0>None</option>
                                                                                <option value=1>นาย - Mr. </option>
                                                                                <option value=2>นาง - Mrs.</option>
                                                                                <option value=3>นางสาว - Miss.</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Name(TH) <span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <div class="form-floating">
                                                                                <input class="form-control" id="txt_first_name_th_edit" type="text" placeholder="" value="">
                                                                                <label for="txt_first_name_th_edit" class="fw-normal text-secondary">ชื่อ</label>
                                                                            </div>
                                                                            <div class="form-floating">
                                                                                <input class="form-control" id="txt_last_name_th_edit" type="text" placeholder="" value="">
                                                                                <label for="txt_last_name_th_edit" class="fw-normal text-secondary">นามสกุล</label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Name(EN)<span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <div class="form-floating">
                                                                                <input class="form-control" id="txt_first_name_en_edit" type="text" placeholder="" value="">
                                                                                <label for="txt_first_name_en_edit" class="fw-normal text-secondary">First name</label>
                                                                            </div>
                                                                            <div class="form-floating">
                                                                                <input class="form-control" id="txt_last_name_en_edit" type="text" placeholder="" value="">
                                                                                <label for="txt_last_name_en_edit" class="fw-normal text-secondary">Last name</label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Mobile</label>
                                                                        <div class="col-sm-9">
                                                                            <input class="form-control digits" id="txt_number_edit" type="text" placeholder="" value="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Email</label>
                                                                        <div class="col-sm-9">
                                                                            <input class="form-control" id="txt_email_edit" type="email" placeholder="Example@email.com" value="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Department <span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <select class="form-select btn-square digits" id="ddl_Department_edit">
                                                                                <option value="">— เลือกแผนก —</option>
                                                                                @foreach (var d in departments)
                                                                                {
                                                                                    var val = (d.ValueInt ?? d.Value ?? d.ID ?? "").ToString();
                                                                                    var text = (d.Text ?? d.Name ?? d.Display ?? "").ToString();
                                                                                    <option value="@val">@text</option>
                                                                                }
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">BU</label>
                                                                        <div class="col-sm-9">
                                                                            <select class="form-select btn-square digits" id="ddl_Bu_edit" multiple>
                                                                                @foreach (var bu in buList)
                                                                                {
                                                                                    var val = (bu.ID ?? bu.ValueInt ?? bu.Value ?? "").ToString();
                                                                                    var text = (bu.Name ?? bu.Text ?? "").ToString();
                                                                                    <option value="@val">@text</option>
                                                                                }
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Role <span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <select class="form-select btn-square digits" id="ddl_Role_edit">
                                                                                <option value="">— เลือก Role —</option>
                                                                                @foreach (var r in roles)
                                                                                {
                                                                                    var val = (r.ValueInt ?? r.Value ?? r.ID ?? "").ToString();
                                                                                    var text = (r.Text ?? r.Name ?? r.Display ?? "").ToString();
                                                                                    <option value="@val">@text</option>
                                                                                }
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">User ID<span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <input class="form-control" id="txt_userid_edit" type="text" placeholder="User name" value="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Password <span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <input class="form-control" id="txt_password_edit" type="password" placeholder="Password" value="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3 row">
                                                                        <label class="col-sm-3">Comfirm <span class="text-danger">*</span></label>
                                                                        <div class="col-sm-9">
                                                                            <input class="form-control" id="txt_comfirm_password_edit" type="password" placeholder="Comfirm Password" value="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <label class="col-sm-3">Flag</label>
                                                                        <div class="col-sm-9">
                                                                            <div class="form-check form-switch">
                                                                                <input class="form-check-input" id="chk_Flag_admin_edit" type="checkbox" role="switch" onchange="updateSwitchLabel(this)">
                                                                                <label class="form-check-label custom-switch-label" for="chk_Flag_admin_edit">Flag Admin</label>
                                                                            </div>
                                                                            <div class="form-check form-switch">
                                                                                <input class="form-check-input" id="chk_Flag_readonly_edit" type="checkbox" role="switch" checked onchange="updateSwitchLabel(this)">
                                                                                <label class="form-check-label custom-switch-label" for="chk_Flag_readonly_edit">Flag Readonly</label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-footer text-end">
                                                            <div class="col-sm-9 offset-sm-3">
                                                                <button class="btn btn-primary me-3" type="submit" id="save_edit_user">Save</button>
                                                                <input class="btn btn-light" type="reset" id="cancel_edit_user"  value="Cancel">
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="tab-pane fade" id="bottom-inbox" role="tabpanel" aria-labelledby="bottom-inbox-tab">
                                                    <!-- ช่องค้นหาอยู่ใน card-header -->
                                                    <div class="card-header d-flex gap-2 align-items-center">
                                                        <input type="text" id="searchProjectsUserMapping" class="form-control"
                                                               placeholder="🔍 ค้นหา BU / ชื่อโครงการ / ชื่ออังกฤษ">

                                                        <select id="filterCheckedState" class="form-select" style="max-width:220px;">
                                                            <option value="all">ทั้งหมด (All)</option>
                                                            <option value="checked">ที่ติ๊กไว้ (Checked)</option>
                                                            <option value="unchecked">ที่ยังไม่ติ๊ก (Unchecked)</option>
                                                        </select>
                                                    </div>
                                                    <!-- ตารางอยู่ใน card-body -->
                                                    <div class="card-body p-0" style="height: 900px; overflow-y: auto; overflow-x: hidden;">
                                                        <table class="table" id="Tb_ProjectsUserMapping">
                                                            <thead>
                                                                <tr>
                                                                    <th class="active">
                                                                        #
                                                                    </th>
                                                                    <th>BU</th>
                                                                    <th>Project</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>

                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div class="card-footer text-end">
                                                        <div class="col-sm-9 offset-sm-3">
                                                            <button class="btn btn-primary me-3" type="submit" id="save_user_project">Save</button>
                                                        </div>
                                                    </div>                                         
                                                </div>
                                            </div>
                                        </div>
                                </div>
                                </div>
                        </div>
                    </div>
                    </div>
                    <div class="tab-pane fade" id="permission-filter" role="tabpanel" aria-labelledby="permission-tab">


                        <!-- Permission Tab Content (HTML-only mockup) -->
                        
                        <div class="card-body">
                            <div class="row g-3">

                                <!-- LEFT: Department & Role management -->
                                <div class="col-lg-4">
                                    <!-- Departments -->
                                    <div class="card shadow-sm mb-3">
                                        <div class="card-header d-flex align-items-center justify-content-between">
                                            <div>
                                                <h6 class="mb-0">Departments</h6>
                                                <small class="text-muted">Manage department list</small>
                                            </div>
                                            <div class="btn-group">
                                                <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#mdlDeptAdd">
                                                    <i class="bi bi-plus-lg"></i> Add
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body pt-2">
                                            <div class="list-group dept-list vertical-scroll scroll-demo scroll-b-none" style="height: 300px; overflow-y: auto; overflow-x: hidden;">
                                                <!-- Departments -->
                                                @foreach (var d in departments)
                                                {
                                                    var text = (d.Text ?? d.Name ?? d.Display ?? "").ToString();
                                                    var val = (d.ValueInt ?? d.Value ?? d.ID ?? "").ToString();
                                                    <div class="list-group-item list-group-item-action d-flex align-items-center justify-content-between dept-item"
                                                         data-id="@val" data-name="@text">
                                                        <div class="dept-name text-truncate" title="@text">
                                                            <i class="bi bi-building text-primary me-2"></i>
                                                            <span class="fw-semibold"><a>@text</a></span>
                                                        </div>
                                                        <button class="btn btn-light rounded-circle btn-icon" title="Edit" data-bs-toggle="modal" data-bs-target="#mdlDeptEdit">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                    </div>
                                                }

                                            </div>
                                        </div>
                                    </div>

                                    <!-- Roles -->
                                    <div class="card shadow-sm">
                                        <div class="card-header d-flex align-items-center justify-content-between">
                                            <div>
                                                <h6 class="mb-0">Roles</h6>
                                                <small class="text-muted">Manage role list</small>
                                            </div>
                                            <div class="btn-group">
                                                <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#mdlRoleAdd">
                                                    <i class="bi bi-plus-lg"></i> Add
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body pt-2">
                                            <div class="list-group dept-list vertical-scroll scroll-demo scroll-b-none" style="height: 300px; overflow-y: auto; overflow-x: hidden;">
                                                <!-- Roles -->
                                                @foreach (var r in roles)
                                                {
                                                    var text = (r.Text ?? r.Name ?? r.Display ?? "").ToString();
                                                    var val = (r.ValueInt ?? r.Value ?? r.ID ?? "").ToString();
                                                    <div class="list-group-item list-group-item-action d-flex align-items-center justify-content-between role-item"
                                                         data-id="@val" data-name="@text">
                                                        <div class="dept-name text-truncate" title="@text">
                                                            <i class="bi bi-shield-lock text-primary me-2"></i>
                                                            <span class="fw-semibold"><a>@text</a></span>
                                                        </div>
                                                        <button class="btn btn-light rounded-circle btn-icon" title="Edit" data-bs-toggle="modal" data-bs-target="#mdlRoleEdit">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                    </div>
                                                }

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- RIGHT: Permission Matrix -->
                                <div class="col-lg-8">
                                    <div class="card shadow-sm h-100">
                                        <div class="card-header">
                                            <div class="d-flex flex-wrap align-items-center gap-2">
                                                <div class="me-auto">
                                                    <h6 class="mb-0">Permission Matrix</h6>
                                                    <small class="text-muted">Department: <strong id="Dep_select"></strong> • Role: <strong id="Role_select"></strong></small>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="card-body p-0">
                                            <div class="permission-table-wrap">
                                                <div class="permission-table-wrap">
                                                    <table id="permissionMatrixTable" class="table table-hover align-middle mb-0 permission-table">
                                                        <thead class="table-light sticky-top">
                                                            <tr>
                                                                <th class="sticky-col">Page / Module</th>
                                                                <th class="text-center">View</th>
                                                                <th class="text-center">Add</th>
                                                                <th class="text-center">Edit</th>
                                                                <th class="text-center">Delete</th>
                                                                <th class="text-center">Download</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="permissionMatrixBody">
                                                            <!-- Rows will be rendered by JS -->
                                                        </tbody>
                                                    </table>
                                                </div>

                                            </div>

                                            <div class="px-3 py-2 border-top small text-muted">
                                                <span class="me-3"><span class="legend-box legend-yes"></span> checkbox available</span>
                                                <span><span class="legend-box legend-no"></span> no checkbox for this action</span>
                                            </div>
                                        </div>

                                        <!-- Footer buttons -->
                                        <div class="card-footer d-flex justify-content-end gap-2">
                                            <button id="btnResetPermissions" class="btn btn-light" disabled>Reset</button>
                                            <button id="btnSavePermissions" class="btn btn-primary" disabled>Save</button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        

                        <!-- Mockup Modals (static) -->
                        <div class="modal fade" id="mdlDeptAdd" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header"><h5 class="modal-title">Add Department</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <label class="form-label">Department Name</label>
                                            <input type="text" class="form-control" placeholder="e.g., Development" disabled>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Code</label>
                                            <input type="text" class="form-control" placeholder="e.g., DEV" disabled>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-primary" disabled>Save</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="mdlDeptEdit" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header"><h5 class="modal-title">Edit Department</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <label class="form-label">Department Name</label>
                                            <input type="text" class="form-control" value="Development" disabled>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Code</label>
                                            <input type="text" class="form-control" value="DEV" disabled>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-primary" disabled>Update</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="mdlDeptDelete" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header"><h5 class="modal-title">Delete Department</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                                    <div class="modal-body">
                                        Are you sure you want to delete <strong>Development (DEV)</strong>?
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-danger" disabled>Delete</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="mdlRoleAdd" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header"><h5 class="modal-title">Add Role</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <label class="form-label">Role Name</label>
                                            <input type="text" class="form-control" placeholder="e.g., Manager" disabled>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-primary" disabled>Save</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="mdlRoleEdit" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header"><h5 class="modal-title">Edit Role</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <label class="form-label">Role Name</label>
                                            <input type="text" class="form-control" value="Administrator" disabled>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-primary" disabled>Update</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="mdlRoleDelete" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header"><h5 class="modal-title">Delete Role</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                                    <div class="modal-body">
                                        Are you sure you want to delete <strong>Manager</strong> role?
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                        <button class="btn btn-danger" disabled>Delete</button>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CREATE USER MODAL -->
<div class="modal fade" id="modalCreateUser" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen-lg-down modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <form class="form theme-form" id="create_user_form">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fa fa-user-plus me-2"></i>Create User</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <div class="card-body custom-input">
                        <div class="row">
                            <div class="col">
                                <!-- Title -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">
                                        Title <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-9">
                                        <select class="form-select btn-square digits" id="ddl_Title_create">
                                            <option value="0">None</option>
                                            <option value="1">นาย - Mr.</option>
                                            <option value="2">นาง - Mrs.</option>
                                            <option value="3">นางสาว - Miss.</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Name TH -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Name(TH) <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <div class="form-floating mb-2">
                                            <input class="form-control" id="txt_first_name_th_create" type="text" placeholder="">
                                            <label for="txt_first_name_th_create" class="fw-normal text-secondary">ชื่อ</label>
                                        </div>
                                        <div class="form-floating">
                                            <input class="form-control" id="txt_last_name_th_create" type="text" placeholder="">
                                            <label for="txt_last_name_th_create" class="fw-normal text-secondary">นามสกุล</label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Name EN -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Name(EN) <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <div class="form-floating mb-2">
                                            <input class="form-control" id="txt_first_name_en_create" type="text" placeholder="">
                                            <label for="txt_first_name_en_create" class="fw-normal text-secondary">First name</label>
                                        </div>
                                        <div class="form-floating">
                                            <input class="form-control" id="txt_last_name_en_create" type="text" placeholder="">
                                            <label for="txt_last_name_en_create" class="fw-normal text-secondary">Last name</label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Mobile -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Mobile</label>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txt_number_create" type="text" placeholder="Number">
                                    </div>
                                </div>

                                <!-- Email -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Email</label>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txt_email_create" type="email" placeholder="example@email.com">
                                    </div>
                                </div>

                                <!-- Department -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Department <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <select class="form-select btn-square digits" id="ddl_Department_create">
                                            <option value="">— เลือกแผนก —</option>
                                            @foreach (var d in departments)
                                            {
                                                var val = (d.ValueInt ?? d.Value ?? d.ID ?? "").ToString();
                                                var text = (d.Text ?? d.Name ?? d.Display ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>
                                </div>

                                <!-- BU -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">BU</label>
                                    <div class="col-sm-9">
                                        <select class="form-select btn-square digits" id="ddl_Bu_create" multiple>
                                            @foreach (var bu in buList)
                                            {
                                                var val = (bu.ID ?? bu.ValueInt ?? bu.Value ?? "").ToString();
                                                var text = (bu.Name ?? bu.Text ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>
                                </div>

                                <!-- Role -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Role <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <select class="form-select btn-square digits" id="ddl_Role_create">
                                            <option value="">— เลือก Role —</option>
                                            @foreach (var r in roles)
                                            {
                                                var val = (r.ValueInt ?? r.Value ?? r.ID ?? "").ToString();
                                                var text = (r.Text ?? r.Name ?? r.Display ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>
                                </div>

                                <!-- User / Password -->
                                <div class="mb-3 row">
                                    <label class="col-sm-3">User ID <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txt_userid_create" type="text" placeholder="User ID">
                                    </div>
                                </div>
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Password <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txt_password_create" type="password" placeholder="Password">
                                    </div>
                                </div>
                                <div class="mb-3 row">
                                    <label class="col-sm-3">Confirm <span class="text-danger">*</span></label>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txt_confirm_password_create" type="password" placeholder="Confirm Password">
                                    </div>
                                </div>

                                <!-- Flags -->
                                <div class="row">
                                    <label class="col-sm-3">Flag</label>
                                    <div class="col-sm-9">
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" id="chk_Flag_admin_create" type="checkbox" role="switch">
                                            <label class="form-check-label custom-switch-label" for="chk_Flag_admin_create">Flag Admin</label>
                                        </div>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" id="chk_Flag_readonly_create" type="checkbox" role="switch" checked>
                                            <label class="form-check-label custom-switch-label" for="chk_Flag_readonly_create">Flag Readonly</label>
                                        </div>
                                    </div>
                                </div>

                            </div> <!-- col -->
                        </div> <!-- row -->
                    </div> <!-- card-body -->
                </div> <!-- modal-body -->

                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="btnCreateUserSave">Create</button>
                </div>
            </form>
        </div>
    </div>
</div>


@section Scripts {
    <link rel="stylesheet" type="text/css" href="~/css/userandpermission.css?ver=@DateTime.Now.Ticks.ToString()">
    <script src="~/js/Pages/UserAndPermission/UserAndPermission.js?ver=@DateTime.Now.Ticks.ToString()"></script>
}