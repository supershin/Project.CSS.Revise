@using Project.CSS.Revise.Web.Models.Master
@{
    Layout = "~/Views/Shared/_LayoutSite.cshtml";
}
<style>
    .card-header {
        border-bottom: 1px solid #dee2e6;
    }
    .date-item-box {
        min-width: 120px;
        text-align: center;
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid #ccc;
        background-color: white;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
    }

    .date-item-box.active {
        border: 2px solid #006666;
        font-weight: bold;
        background-color: #f0fdfa;
    }

    .date-day {
        font-size: 14px;
        color: #555;
    }

    .date-full {
        font-size: 16px;
        font-weight: 500;
    }

    .form-check {
        min-width: max-content; /* ป้องกัน label ขึ้นบรรทัดเอง */
    }

    .form-check-label {
        color: #000 !important; /* สีดำและบังคับ */
    }

    .btn-circle {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        padding: 5px 0;
        text-align: center;
        font-size: 14px;
    }

</style>

<div class="container-fluid">
    <div class="page-title">
        <div class="row">
            <div class="col-6">
                <h4>Other Settings</h4>
            </div>
            <div class="col-6">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">

                    </li>
                    <li class="breadcrumb-item">Pages</li>
                    <li class="breadcrumb-item active">Other Settings</li>
                </ol>
            </div>
        </div>
    </div>
</div>
<!-- Container-fluid starts-->
<div class="container-fluid">
    <div class="row size-column">
        <div class="box-col-12">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <ul class="simple-wrapper nav nav-tabs" id="Other-Settings-Tab-filter" role="tablist">
                                <li class="nav-item"><a class="nav-link txt-primary" id="counter-tab" data-bs-toggle="tab" href="#counter-filter" role="tab" aria-controls="counter-tab" aria-selected="true"><i class="icofont icofont-cube"></i>Counter</a></li>
                                <li class="nav-item"><a class="nav-link active txt-primary" id="shop-event-tab" data-bs-toggle="tab" href="#shop-event-filter" role="tab" aria-controls="shop-event-tab" aria-selected="false"><i class="icofont icofont-travelling"></i>Shop & Event</a></li>
                                <li class="nav-item"><a class="nav-link txt-primary" id="project-zone-tab" data-bs-toggle="tab" href="#project-zone-filter" role="tab" aria-controls="project-zone-tab" aria-selected="false"><i class="icofont icofont-map"></i>Project Zone</a></li>
                            </ul>
                            <div class="tab-content" id="Other-Settings-Tab-filter-Content">
                                <div class="tab-pane fade" id="counter-filter" role="tabpanel" aria-labelledby="counter-tab">
                                    <p class="pt-3">Tabs have long been used to show alternative views of the same group of information tabs in software. Known as<em class="txt-danger"> “module tabs”</em>, these are still used today in web sites. For instance, airline companies such as Ryanair, easyJet and AirMalta use module tabs to enable the user to switch between bookings for flights, hotels and car hire.</p>
                                </div>
                                <div class="tab-pane fade show active" id="shop-event-filter" role="tabpanel" aria-labelledby="shop-event-tab">
                                    <div class="pt-4 px-2 px-md-3">
                                        <div class="row">
                                            <div class="col-12">
                                                <form id="filterForm" class="filter-bar d-flex flex-wrap justify-content-center align-items-center gap-2">
                                                    <!-- BU -->
                                                    <div class="filter-item">
                                                        <select id="ddl-bu-shop-event" class="form-select">
                                                        </select>
                                                    </div>

                                                    <!-- Project -->
                                                    <div class="filter-item" id="project-dropdown-container">
                                                        <div id="project-loading" style="display: none;">
                                                            <div class="spinner-border text-primary spinner-border-sm" role="status">
                                                                <span class="visually-hidden">Loading...</span>
                                                            </div> กำลังโหลด...
                                                        </div>
                                                        <select id="ddl-project-shop-event" class="form-select">
                                                            <option value="">เลือกโครงการ</option>
                                                        </select>
                                                    </div>

                                                    <!-- Year -->
                                                    <div class="filter-item">
                                                        <select id="ddl-year-shop-event" class="form-select">
                                                            <option value="">เลือกปี</option>
                                                        </select>
                                                    </div>

                                                    <!-- Search Button -->
                                                    <button type="button" class="btn btn-primary search-btn d-flex align-items-center gap-1" id="btn-search-shop-event" onclick="LoadPartialshopevent()">
                                                        <i class="fa fa-search"></i>
                                                        <span class="d-none d-md-inline">Search</span>
                                                    </button>
                                                </form>
                                            </div>
                                            <div class="col-12">
                                                <div class="box-col-12" id="Box_show_partial">

                                                </div>
                                            </div>
                                        </div>
                                       
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="project-zone-filter" role="tabpanel" aria-labelledby="project-zone-tab">
                                    <ul class="pt-3 d-flex flex-column gap-1">
                                        <li>Us Technology offers web & mobile development solutions for all industry verticals.Include a short form using fields that'll help your business understand who's contacting them.</li>
                                        <li> <strong>Visit Us: </strong> 2600 Hollywood Blvd,Florida, United States-	33020</li>
                                        <li> <strong>Mail Us:</strong> contact@us@gmail.com</li>
                                        <li> <strong>Contact Number: </strong> (954) 357-7760</li>
                                    </ul>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    <div class="modal fade bd-example-modal-lg" id="modal-new-event" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModal" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="myExtraLargeModal">New Event</h4>
                    <button class="btn-close py-0" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body dark-modal">
                    <div class="card-body">
                        <ul class="simple-wrapper nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item"><a class="nav-link active txt-primary" id="modal-Event-add-tab" data-bs-toggle="tab" href="#modal-Event-add" role="tab" aria-controls="modal-Event-add" aria-selected="true"><i class="fa fa-calendar" aria-hidden="true"></i>Event</a></li>
                            <li class="nav-item" id="li-tab-shop">
                                <a class="nav-link txt-primary" id="modal-Shop-add-tab" data-bs-toggle="tab" href="#modal-Shop-add" role="tab" aria-controls="modal-Shop-add" aria-selected="false">
                                    <i class="fa fa-shopping-basket" aria-hidden="true"></i>Shop
                                </a>
                            </li>
                        </ul>
                        <div class="tab-content" id="myTabContent">
                            <div class="tab-pane fade show active" id="modal-Event-add" role="tabpanel" aria-labelledby="modal-Event-add-tab">
                                <div class="card-body custom-input p-3">
                                    <form class="form theme-form">
                                        <div class="card-body custom-input">
                                            <div class="row">
                                                <div class="col">
                                                    <div class="mb-3 row">
                                                        <label class="col-sm-3">Event</label>
                                                        <div class="col-sm-9">
                                                            <input class="form-control" type="text" placeholder="Event name" id="txt-modal-new-event-name">
                                                        </div>
                                                    </div>
                                                    <div class="mb-3 row">
                                                        <label class="col-sm-3 pt-0">Event type</label>
                                                        <div class="col-sm-5">
                                                            <input class="form-control" type="text" placeholder="Event type name" id="txt-modal-new-event-type-name" maxlength="100">
                                                        </div>
                                                        <div class="col-sm-2">
                                                            <input class="form-control form-control-color" type="color" value="#006666" id="color-modal-new-event-type-color">
                                                        </div>
                                                    </div>
                                                    <div class="mb-3 row">
                                                        <label class="col-sm-3">Location</label>
                                                        <div class="col-sm-9">
                                                            <input class="form-control" type="text" placeholder="Location" id="txt-modal-new-event-location">
                                                        </div>
                                                    </div>
                                                    <div class="mb-3 row">
                                                        <label class="col-sm-3">Tag</label>
                                                        <div class="col-sm-9">
                                                            <input id="tags-modal-new-event-tags" class="form-control" placeholder="เพิ่มแท็กใหม่หรือเลือกจากรายการ"/>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3 row">
                                                        <label class="col-sm-3 col-form-label fw-bold">Project</label>
                                                        <div class="col-sm-9">
                                                            <select id="ddl-modal-new-event-projects" class="form-control" multiple>
                                                                @foreach (var item in ViewBag.listDDlAllProject)
                                                                {
                                                                    <option value="@item.ValueString">@item.Text</option>
                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3 row align-items-center">
                                                        <label class="col-sm-3">Date and Time</label>

                                                        <div class="col-sm-4">
                                                            <input class="form-control" id="txt-modal-new-event-start-date-time" placeholder="Start DateTime">
                                                        </div>

                                                        <div class="col-sm-1 text-center fw-bold">-</div>

                                                        <div class="col-sm-4">
                                                            <input class="form-control" id="txt-modal-new-event-end-date-time" placeholder="End DateTime">
                                                        </div>
                                                    </div>
                                                    <div class="mb-3 row align-items-center">
                                                        <label class="col-sm-3">สถานะการใช้งาน</label>
                                                        <div class="col-sm-9">
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox" id="tg-modal-new-event-status" checked disabled>
                                                                <label class="form-check-label" for="tg-modal-new-event-status">เปิดใช้งาน</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-footer text-end">
                                            <div class="col-sm-9 offset-sm-3">
                                                <button class="btn btn-primary me-3" type="submit">Save</button>
                                                <input class="btn btn-light" type="reset" value="Cancel">
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="modal-Shop-add" role="tabpanel" aria-labelledby="modal-Shop-add-tab">
                                <div class="card-body custom-input p-3">
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="card shadow-sm border rounded mb-3">
                                                <div class="card-header bg-white fw-bold" style="font-size: 1rem;">
                                                    <i class="fa fa-calendar me-1 text-primary"></i> เลือกวันที่ของกิจกรรม
                                                </div>
                                                <div class="card-body py-3">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <button type="button" class="btn" id="btn-date-prev">&lt;</button>

                                                        <div class="flex-grow-1 mx-2 overflow-auto" style="white-space: nowrap;" id="date-scroll-wrapper">
                                                            <div class="d-inline-flex gap-2" id="date-scroll-list">
                                                                <!-- วันจะโหลดด้วย JS -->
                                                            </div>
                                                        </div>

                                                        <button type="button" class="btn" id="btn-date-next">&gt;</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="card shadow-sm border rounded mb-3 checkbox-checked">
                                                <div class="card-header bg-white fw-bold" style="font-size: 1rem;">
                                                    <i class="fa fa-building-o me-1 text-primary"></i> เลือกโครงการที่ร่วมกิจกรรมในวันนี้
                                                </div>
                                                <div class="card-body py-3 d-flex flex-wrap gap-3">
                                                    <div class="form-check checkbox checkbox-primary mb-0">
                                                        <input class="form-check-input" id="checkbox-primary-1" type="checkbox" checked="">
                                                        <label class="form-check-label" for="checkbox-primary-1">มารูน รัชดา</label>
                                                    </div>
                                                    <div class="form-check checkbox checkbox-primary mb-0">
                                                        <input class="form-check-input" id="checkbox-primary-2" type="checkbox">
                                                        <label class="form-check-label" for="checkbox-primary-2">เคฟ วันเดอร์แลนด์</label>
                                                    </div>
                                                    <div class="form-check checkbox checkbox-primary mb-0">
                                                        <input class="form-check-input" id="checkbox-primary-3" type="checkbox" checked="">
                                                        <label class="form-check-label" for="checkbox-primary-3">แอทโมซ พาลาซิโอ ลาดพร้าว-วังหิน</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> 
                                        <style>
                                            .shop-card {
                                                border: 1px solid #e0e0e0;
                                                border-radius: 10px;
                                                padding: 15px;
                                                display: flex;
                                                align-items: center;
                                                flex-wrap: wrap;
                                                gap: 15px;
                                                background-color: #fdfdfd;
                                            }

                                                .shop-card .form-check-label {
                                                    font-weight: bold;
                                                    color: #000;
                                                }

                                                .shop-card .form-control {
                                                    width: 100px;
                                                }

                                                .shop-card .form-switch {
                                                    margin-left: 10px;
                                                }

                                            .shop-actions {
                                                margin-left: auto;
                                                display: flex;
                                                gap: 10px;
                                            }
                                        </style>

                                        <div class="col-12">
                                            <div class="card shadow-sm border rounded mb-3">
                                                <div class="card-header bg-white fw-bold" style="font-size: 1rem;">
                                                    <i class="fa fa-shopping-basket me-1 text-primary"></i> ระบุร้านค้าที่ร่วมกิจกรรมนี้
                                                </div>
                                                <div class="card-body p-3">
                                                    <!-- 🔁 Shop Row -->
                                                    <div class="shop-line">
                                                        <div class="form-check me-2">
                                                            <input class="form-check-input" type="checkbox" checked>
                                                        </div>
                                                        <div class="shop-label">บ้านไร่กาแฟ</div>

                                                        <div class="quota">
                                                            <input type="number" class="form-control form-control-sm" value="150">
                                                        </div>

                                                        <div class="per-unit">
                                                            <input type="number" class="form-control form-control-sm" value="2">
                                                        </div>

                                                        <div class="switch">
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox" role="switch" checked>
                                                            </div>
                                                        </div>


                                                        <div class="action-btns">
                                                            <button class="btn btn-sm btn-primary"><i class="fa fa-edit"></i></button>
                                                            <button class="btn btn-sm btn-danger"><i class="fa fa-trash"></i></button>
                                                        </div>
                                                    </div>

                                                    <!-- 🔁 Copy เพิ่มได้ -->
                                                    <div class="shop-line">
                                                        <div class="form-check me-2">
                                                            <input class="form-check-input" type="checkbox">
                                                        </div>
                                                        <div class="shop-label">WorkShop</div>

                                                        <div class="quota">
                                                            <input type="number" class="form-control form-control-sm" value="30">
                                                        </div>

                                                        <div class="per-unit">
                                                            <input type="number" class="form-control form-control-sm" value="1">
                                                        </div>

                                                        <div class="switch">
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox">
                                                            </div>
                                                        </div>

                                                        <div class="action-btns">
                                                            <button class="btn btn-sm btn-primary"><i class="fa fa-edit"></i></button>
                                                            <button class="btn btn-sm btn-danger"><i class="fa fa-trash"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>           
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <!-- ✅ FullCalendar v6.1.10 + moment + ภาษาไทย -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/locales/th.global.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="~/css/shopandevent.css?ver=@DateTime.Now.Ticks.ToString()">

    <script src="~/js/Pages/OtherSetting/index.js?ver=@DateTime.Now.Ticks.ToString()"></script>
    <script src="~/js/Pages/OtherSetting/Partial_shop_event.js?ver=@DateTime.Now.Ticks.ToString()"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        flatpickr("#txt-modal-new-event-start-date-time", {
            enableTime: true,
            time_24hr: true,
            dateFormat: "Y-m-d H:i", // Example: 2025-06-30 13:45
            defaultHour: 9,
            defaultMinute: 0
        });

        flatpickr("#txt-modal-new-event-end-date-time", {
            enableTime: true,
            time_24hr: true,
            dateFormat: "Y-m-d H:i",
            defaultHour: 18,
            defaultMinute: 0
        });

        let tagifyInstance;

        document.addEventListener('DOMContentLoaded', function () {
            const input = document.getElementById('tags-modal-new-event-tags');

            const whitelistFromServer = @Html.Raw(Json.Serialize(
            ((List<GetDDLModel>)ViewBag.Listtag).Select(t => new { value = t.Text })
        ));

            tagifyInstance = new Tagify(input, {
                whitelist: whitelistFromServer,
                enforceWhitelist: false, // ✅ อนุญาตให้พิมพ์เองได้
                dropdown: {
                    enabled: 0,
                    closeOnSelect: false,
                    fuzzySearch: true,
                    highlightFirst: true,
                    maxItems: 20
                }
            });

            // ✅ แสดง dropdown เมื่อ focus
            input.addEventListener('focus', () => {
                tagifyInstance.dropdown.show.call(tagifyInstance, '');
            });

            // ❌ ตัด AJAX add tag ทิ้ง เพราะจะบันทึกตอน submit แทน
            // tagifyInstance.on('add', function (e) {...});
        });

    </script>
    <script>
        let shopIndex = 0;

        function addShopCard(name = '', quota = '', unitPer = '', isActive = true, isChecked = false) {
            const id = `shop_${shopIndex++}`;
            const checked = isChecked ? 'checked' : '';
            const active = isActive ? 'checked' : '';

            const html = `
                <div class="shop-card" data-id="${id}">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="cb-${id}" ${checked}>
                        <label class="form-check-label" for="cb-${id}">${name || 'ชื่อร้านค้า'}</label>
                    </div>
                    <input type="number" class="form-control" placeholder="จำนวนโควต้า" value="${quota}" ${!isChecked ? 'disabled' : ''}>
                    <input type="number" class="form-control" placeholder="สิทธิ์ต่อ Unit" value="${unitPer}" ${!isChecked ? 'disabled' : ''}>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" ${active}>
                    </div>
                    <div class="shop-actions">
                        <button class="btn btn-sm btn-primary"><i class="fa fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger btn-delete-shop"><i class="fa fa-trash"></i></button>
                    </div>
                </div>
            `;

            $('#shopCardList').append(html);
        }

        // ➕ ปุ่มเพิ่มร้าน
        $('#btnAddShop').on('click', function () {
            addShopCard();
        });

        // 🗑 ลบร้าน
        $(document).on('click', '.btn-delete-shop', function () {
            $(this).closest('.shop-card').remove();
        });

        // ✅ เปิด checkbox → enable input
        $(document).on('change', '.form-check-input[type="checkbox"]', function () {
            const container = $(this).closest('.shop-card');
            const isChecked = $(this).is(':checked');
            container.find('input[type="number"]').prop('disabled', !isChecked);
        });

        // 👇 Mockup เริ่มต้น
        $(document).ready(function () {
            addShopCard('Egg Drop', 100, 2, true, true);
            addShopCard('บ้านไร่กาแฟ', 150, 2, true, true);
            addShopCard('WorkShop', 30, 1, true, true);
        });
    </script>

@*     <script>
        let shopIndex = 0;

        function addShopCard(name = '', quota = '', unitPer = '', isActive = true, isChecked = false) {
            const id = `shop_${shopIndex++}`;
            const checked = isChecked ? 'checked' : '';
            const active = isActive ? 'checked' : '';

            const html = `
                <div class="shop-card col-12" data-id="${id}">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="cb-${id}" ${checked}>
                        <label class="form-check-label" for="cb-${id}">${name || 'ชื่อร้านค้า'}</label>
                    </div>
                    <input type="number" class="form-control" placeholder="จำนวนโควต้า" value="${quota}" ${!isChecked ? 'disabled' : ''}>
                    <input type="number" class="form-control" placeholder="สิทธิ์ต่อ Unit" value="${unitPer}" ${!isChecked ? 'disabled' : ''}>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" ${active}>
                    </div>
                    <div class="shop-actions">
                        <button class="btn btn-sm btn-primary"><i class="fa fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger btn-delete-shop"><i class="fa fa-trash"></i></button>
                    </div>
                </div>
            `;

            $('#shopCardList').append(html);
        }

        // ➕ ปุ่มเพิ่มร้าน
        $('#btnAddShop').on('click', function () {
            addShopCard();
        });

        // 🗑 ลบร้าน
        $(document).on('click', '.btn-delete-shop', function () {
            $(this).closest('.shop-card').remove();
        });

        // ✅ เปิด checkbox → enable input
        $(document).on('change', '.form-check-input[type="checkbox"]', function () {
            const container = $(this).closest('.shop-card');
            const isChecked = $(this).is(':checked');
            container.find('input[type="number"]').prop('disabled', !isChecked);
        });

        // 👇 Mockup เริ่มต้น
        $(document).ready(function () {
            addShopCard('Egg Drop', 100, 2, true, true);
            addShopCard('บ้านไร่กาแฟ', 150, 2, true, true);
            addShopCard('WorkShop', 30, 1, true, true);
        });
    </script> *@


}


