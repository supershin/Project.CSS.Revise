@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutSite.cshtml";
    var buList = ViewBag.listBu as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var ExpecttransferList = ViewBag.listExpecttransfer as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var UnitstatuscsList = ViewBag.listUnitstatuscs as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var CSResponsList = ViewBag.listgCSRespons as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var EditCSResponsList = ViewBag.listgCSResponsEdit as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var CareerList = ViewBag.listCareer as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var ReasonList = ViewBag.listReason as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var BankList = ViewBag.listBank as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var BankNonSubmissionReasonList = ViewBag.listBankNonSubmissionReason as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
}

<div class="container-fluid">
    <div class="page-title">
        <div class="row">
            <div class="col-6">
                <h4>Queue Bank</h4>
            </div>
            <div class="col-6">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="index.html">
                            <svg class="stroke-icon">
                                <use xlink:href="@Url.Content("~/assets/svg/icon-sprite.svg#stroke-home")"></use>
                            </svg>
                        </a>
                    </li>
                    <li class="breadcrumb-item">Queue</li>
                    <li class="breadcrumb-item active">Queue Bank</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <!-- Filters card -->
    <div class="card filter-card">
        <div class="card-header d-flex align-items-center justify-content-between">
            <h5 class="mb-0">Filters</h5>
            <button class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-1"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#fltCollapse"
                    aria-expanded="true"
                    aria-controls="fltCollapse">
                <i class="fa fa-chevron-up"></i>
            </button>
        </div>
        <div id="fltCollapse" class="collapse show">
            <div class="card-body">
                <div class="row g-3 filter-grid">
                    <div class="col-12 col-md-4">
                        <label for="ddl_BUG" class="form-label fw-bold">BUG</label>
                        <select id="ddl_BUG" class="form-control multi-select" multiple>
                            @foreach (var bu in buList)
                            {
                                var val = (bu.ID ?? bu.ValueInt ?? bu.Value ?? "").ToString();
                                var text = (bu.Name ?? bu.Text ?? "").ToString();
                                <option value="@val">@text</option>
                            }
                        </select>
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="ddl_Project" class="form-label fw-bold">Project</label>
                        <select id="ddl_Project" class="form-control">

                        </select>
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="ddl_UnitCode" class="form-label fw-bold">Unit Code</label>
                        <select id="ddl_UnitCode" class="form-control multi-select" multiple>

                        </select>
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="ddl_CSResponsible" class="form-label fw-bold">CS Response</label>
                        <select id="ddl_CSResponsible" class="form-control multi-select" multiple>
                            @foreach (var cs in CSResponsList)
                            {
                                var val = (cs.ValueInt ?? "").ToString();
                                var text = (cs.Text ?? "").ToString();
                                <option value="@val">@text</option>
                            }
                        </select>
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="ddl_UnitStatusCS" class="form-label fw-bold">Unit Status</label>
                        <select id="ddl_UnitStatusCS" class="form-control" multiple>
                            @foreach (var et in UnitstatuscsList)
                            {
                                var val = (et.ValueInt ?? "").ToString();
                                var text = (et.Text ?? "").ToString();
                                <option value="@val">@text</option>
                            }
                        </select>
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="ddl_ExpectTransferBy" class="form-label fw-bold">Expect Transfer By</label>
                        <select id="ddl_ExpectTransferBy" class="form-control multi-select" multiple>
                            @foreach (var et in ExpecttransferList)
                            {
                                var val = (et.ValueInt ?? "").ToString();
                                var text = (et.Text ?? "").ToString();
                                <option value="@val">@text</option>
                            }
                        </select>
                    </div>
                    <div class="col-12 col-md-4" id="filter-register-date">
                        <label class="form-label fw-bold">Register Date</label>

                        <div class="input-group">
                            <input type="text"
                                   id="txt_RegisterDateStart"
                                   class="form-control"
                                   placeholder="dd/mm/yyyy">

                            <span class="input-group-text" style="height:38px; display:flex; align-items:center;">-</span>

                            <input type="text"
                                   id="txt_RegisterDateEnd"
                                   class="form-control"
                                   placeholder="dd/mm/yyyy">
                        </div>
                    </div>

                </div>
            </div>
            <div class="card-footer d-flex justify-content-end align-items-center gap-2 flex-nowrap footer-actions p-2">
                <button id="btnFilterCancel" type="button" class="btn btn-outline-secondary btn-sm" onclick="ClearFilter()">
                    <i class="fa fa-undo me-1"></i> Cancel
                </button>
                <button id="btnSearch" class="btn btn-primary btn-sm" type="button">
                    <i class="fa fa-search me-1"></i> Search
                </button>

            </div>
        </div>
    </div>

    <!-- Project Table card -->
    <div class="card filter-card" id="cardProjectTable">
        <div class="card-header d-flex align-items-center justify-content-between">
            <div>
                <h5 class="mb-0" id="project-name-selected">Project Table</h5>
            </div>
            <div class="d-flex align-items-center gap-2">
                <!-- Register button -->
                <button class="btn btn-sm btn-outline-success gap-1" onclick="openCreateRegister()">
                    <i class="fa fa-plus me-1"></i> Register
                </button>

                <!-- collapse arrow -->
                <button class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-1"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#fltCollapseTable"
                        aria-expanded="true"
                        aria-controls="fltCollapseTable">
                    <i class="fa fa-chevron-up"></i>
                </button>
            </div>
        </div>
        <div id="fltCollapseTable" class="collapse show">
            <div class="card-body">
                <div class="project-table-card">
                    <div class="card-body p-3">
                        <table id="QueueBankRegisterTable" class="table table-hover table-nowrap queue-table mb-0">
                            <thead>
                                <tr>
                                    <th>No.</th>
                                    <th>Unit Code</th>
                                    <th>Customer Name</th>
                                    <th>Appointment</th>
                                    <th>Status</th>
                                    <th>Time</th>
                                    <th>Counter</th>
                                    <th>Unit Status</th>
                                    <th>CS Response</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="QueueBankRegisterTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Summary Register card -->
    <div class="card filter-card" id="cardSummaryRegister">
        <div class="card-header d-flex align-items-center justify-content-between">

            <!-- Left side: title + dynamic date -->
            <div>
                <h5 class="mb-0" id="Show_Name_selected">Summary Register Bank : </h5>
                <small id="sum-register-date" class="text-muted"></small> <!-- dynamically updated -->
            </div>

            <!-- Right side buttons -->
            <div class="d-flex align-items-center gap-2">
                <!-- toggle view button -->
                <button id="btnSummaryRegisterToggle"
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                        title="Change view"
                        aria-label="Change view">
                    <i class="fa fa-table" aria-hidden="true"></i>
                    <span class="visually-hidden">Change view</span>
                </button>

                <!-- collapse arrow -->
                <button class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-1"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#fltCollapseSummaryRegister"
                        aria-expanded="true"
                        aria-controls="fltCollapseSummaryRegister">
                    <i class="fa fa-chevron-up"></i>
                </button>
            </div>
        </div>
        <div id="fltCollapseSummaryRegister" class="collapse show">
            <div class="card-body">
                <div class="summary-register">

                    <!-- 🔹 VIEW แบบกล่อง (เดิม) -->
                    <div id="summary-register-box-view">

                        <!-- Row 1: 6 กล่อง -->
                        <div class="summary-row summary-row-6">
                            <!-- Register -->
                            <div class="summary-box bg-green">
                                <h6>Register</h6>
                                <div class="summary-values">
                                    <div><strong id="sum-register-unit">0</strong><br>Unit</div>
                                    <div><strong id="sum-register-value">0.00 M</strong><br>Value</div>
                                </div>
                                <div class="summary-footer" id="sum-register-percent">0%</div>
                            </div>

                            <!-- Queue -->
                            <div class="summary-box bg-blue">
                                <h6>Queue</h6>
                                <div class="summary-values">
                                    <div><strong id="sum-queue-unit">0</strong><br>Unit</div>
                                    <div><strong id="sum-queue-value">0.00 M</strong><br>Value</div>
                                </div>
                                <div class="summary-footer" id="sum-queue-percent">0%</div>
                            </div>

                            <!-- In Process -->
                            <div class="summary-box bg-orange">
                                <h6>In Process</h6>
                                <div class="summary-values">
                                    <div><strong id="sum-inprocess-unit">0</strong><br>Unit</div>
                                    <div><strong id="sum-inprocess-value">0.00 M</strong><br>Value</div>
                                </div>
                                <div class="summary-footer" id="sum-inprocess-percent">0%</div>
                            </div>

                            <!-- Done -->
                            <div class="summary-box bg-green-light">
                                <h6>Done</h6>
                                <div class="summary-values">
                                    <div><strong id="sum-done-unit">0</strong><br>Unit</div>
                                    <div><strong id="sum-done-value">0.00 M</strong><br>Value</div>
                                </div>
                                <div class="summary-footer" id="sum-done-percent">0%</div>
                            </div>

                            <!-- ยื่น -->
                            <div class="summary-box bg-green-light">
                                <h6>ยื่น</h6>
                                <div class="summary-values">
                                    <div><strong id="sum-loan-yes-unit">0</strong><br>Unit</div>
                                    <div><strong id="sum-loan-yes-value">0.00 M</strong><br>Value</div>
                                </div>
                                <div class="summary-footer" id="sum-loan-yes-percent">0%</div>
                            </div>

                            <!-- ไม่ยื่น -->
                            <div class="summary-box bg-pink-soft">
                                <h6>ไม่ยื่น</h6>
                                <div class="summary-values">
                                    <div><strong id="sum-loan-no-unit">0</strong><br>Unit</div>
                                    <div><strong id="sum-loan-no-value">0.00 M</strong><br>Value</div>
                                </div>
                                <div class="summary-footer" id="sum-loan-no-percent">0%</div>
                            </div>
                        </div>

                        <!-- Row 2: Career (Dynamic) -->
                        <div class="summary-row summary-row-6 mt-3" id="careerSummaryRow">
                            @foreach (var item in CareerList)
                            {
                                var id = item.ValueInt;   // ext.ID
                                var text = item.Text;     // ext.Name

                                <div class="summary-box bg-pink">
                                    <h6>@text</h6>

                                    <div class="summary-values">
                                        <div>
                                            <strong id="sum-career-@id-unit">0</strong><br />Unit
                                        </div>
                                        <div>
                                            <strong id="sum-career-@id-value">0.00 M</strong><br />Value
                                        </div>
                                    </div>

                                    <div class="summary-footer" id="sum-career-@id-percent">0%</div>
                                </div>
                            }
                        </div>

                    </div>


                    <!-- 🔹 VIEW แบบ TABLE (ซ่อนตอนเริ่ม) -->
                    <div id="summary-register-table-view" class="d-none">

                        <!-- Group 1: Register / Queue / In Process / Done -->
                        <div class="mb-3">
                            <h6 class="fw-bold mb-2">Register Status</h6>
                            <div class="table-responsive">
                                <table class="table table-sm table-bordered mb-0">
                                    <thead>
                                        <tr>
                                            <th style="width: 160px;">Status</th>
                                            <th class="text-center" style="width: 100px;">Unit</th>
                                            <th class="text-center" style="width: 140px;">Value (M)</th>
                                            <th class="text-center" style="width: 80px;">%</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Register</td>
                                            <td class="text-center" id="tbl-register-unit">0</td>
                                            <td class="text-center" id="tbl-register-value">0.00 M</td>
                                            <td class="text-center" id="tbl-register-percent">0%</td>
                                        </tr>
                                        <tr>
                                            <td>Queue</td>
                                            <td class="text-center" id="tbl-queue-unit">0</td>
                                            <td class="text-center" id="tbl-queue-value">0.00 M</td>
                                            <td class="text-center" id="tbl-queue-percent">0%</td>
                                        </tr>
                                        <tr>
                                            <td>In Process</td>
                                            <td class="text-center" id="tbl-inprocess-unit">0</td>
                                            <td class="text-center" id="tbl-inprocess-value">0.00 M</td>
                                            <td class="text-center" id="tbl-inprocess-percent">0%</td>
                                        </tr>
                                        <tr>
                                            <td>Done</td>
                                            <td class="text-center" id="tbl-done-unit">0</td>
                                            <td class="text-center" id="tbl-done-value">0.00 M</td>
                                            <td class="text-center" id="tbl-done-percent">0%</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Group 2: ยื่น / ไม่ยื่น -->
                        <div class="mb-3">
                            <h6 class="fw-bold mb-2">Loan Status</h6>
                            <div class="table-responsive">
                                <table class="table table-sm table-bordered mb-0">
                                    <thead>
                                        <tr>
                                            <th style="width: 160px;">ประเภท</th>
                                            <th class="text-center" style="width: 100px;">Unit</th>
                                            <th class="text-center" style="width: 140px;">Value (M)</th>
                                            <th class="text-center" style="width: 80px;">%</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>ยื่น</td>
                                            <td class="text-center" id="tbl-loan-yes-unit">0</td>
                                            <td class="text-center" id="tbl-loan-yes-value">0.00 M</td>
                                            <td class="text-center" id="tbl-loan-yes-percent">0%</td>
                                        </tr>
                                        <tr>
                                            <td>ไม่ยื่น</td>
                                            <td class="text-center" id="tbl-loan-no-unit">0</td>
                                            <td class="text-center" id="tbl-loan-no-value">0.00 M</td>
                                            <td class="text-center" id="tbl-loan-no-percent">0%</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Group 3: อาชีพ -->
                        <div>
                            <h6 class="fw-bold mb-2">Career Type</h6>
                            <div class="table-responsive">
                                <table class="table table-sm table-bordered mb-0">
                                    <thead>
                                        <tr>
                                            <th style="width: 160px;">อาชีพ</th>
                                            <th class="text-center" style="width: 100px;">Unit</th>
                                            <th class="text-center" style="width: 140px;">Value (M)</th>
                                            <th class="text-center" style="width: 80px;">%</th>
                                        </tr>
                                    </thead>

                                    <tbody id="tbl-career-body">
                                        @foreach (var item in CareerList)
                                        {
                                            var value = item.ValueInt;   // ext.ID
                                            var text = item.Text;       // ext.Name

                                            <tr>
                                                <td>@text</td>
                                                <td class="text-center" id="tbl-@value-unit">0</td>
                                                <td class="text-center" id="tbl-@value-value">0.00 M</td>
                                                <td class="text-center" id="tbl-@value-percent">0%</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div> 
                    <!-- /table view -->

                </div>
            </div>
        </div>
    </div>

    <!--  Summary Bank card -->
    <div class="card filter-card" id="cardSummaryBank">
        <div class="card-header d-flex align-items-center justify-content-between">
            <div>
                <h5 class="mb-0" id="Show_Name_selected2">Summary Bank & Non-Submission Reason : </h5>
                <small id="sum-register-date2" class="text-muted"></small>
            </div>
            <button class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-1"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#fltCollapseSummaryBank"
                    aria-expanded="true"
                    aria-controls="fltCollapseSummaryBank">
                <i class="fa fa-chevron-up"></i>
            </button>
        </div>
        <div id="fltCollapseSummaryBank" class="collapse show">
            <div class="card-body">
                <div class="row">
                    <div class="col-8">
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle summary-bank-table">
                                <thead>
                                    <tr>
                                        <th style="width: 340px;">ธนาคาร</th>
                                        <th style="width: 160px;">อัตราดอกเบี้ยเฉลี่ย 3 ปี</th>
                                        <th style="width: 120px;">จำนวน</th>
                                        <th style="width: 160px;">มูลค่า</th>
                                        <th style="width: 100px;">%</th>
                                    </tr>
                                </thead>
                                <tbody id="summary-bank-body">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">
                                            Loading...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle summary-bank-table">
                                <thead>
                                    <tr>
                                        <th style="width: 340px;">เหตุผลไม่ยื่น</th>
                                        <th style="width: 160px;">จำนวน</th>
                                        <th style="width: 100px;">%</th>
                                    </tr>
                                </thead>
                                <tbody id="summary-banknonsubmissionreason-body">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">
                                            Loading...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
               </div>          
            </div>
        </div>
    </div>

</div>

<div class="container-fluid mb-3">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">

        <!-- Left: Back Button -->
        <button id="btnBack" class="btn d-flex align-items-center gap-1">
            <i class="fa fa-arrow-left"></i> Back
        </button>

        <!-- Right: Action Buttons -->
        <div class="d-flex align-items-center gap-2 flex-wrap">
            <!-- Capture -->
            <button id="btnCapture" class="btn btn-primary d-flex align-items-center gap-1">
                <i class="fa fa-camera"></i> Capture
            </button>

            <!-- Export (Excel) -->
            <button id="btnExport" class="btn d-flex align-items-center gap-1">
                <i class="fa fa-file-excel-o" aria-hidden="true"></i> Export
            </button>

            <!-- Customer View (Desktop) -->
            <button id="btnCustomerView" class="btn btn-success d-flex align-items-center gap-1">
                <i class="fa fa-desktop"></i> Customer
            </button>

            <button id="btnChecker" class="btn btn-warning d-flex align-items-center gap-1">
                <i class="fa fa-check-square"></i> Checker
            </button>

            <button id="btnCounter" class="btn btn-info d-flex align-items-center gap-1">
                <i class="fa fa-list-ol"></i> Counter
            </button>



        </div>

    </div>
</div>

<!-- Modal: Create Register -->
<div class="modal fade" id="modalCreateRegister" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen modal-dialog-scrollable">
        <div class="modal-content" id="cr-modal">

            <!-- Header -->
            <div class="modal-header cr-header">
                <h5 class="modal-title">Create Register</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <div class="modal-body">

                <!-- Unit Code + Save -->
                <div class="row justify-content-center align-items-center g-2 mb-3">
                    <div class="col-auto">
                        <label for="DDLUnitCode" class="col-form-label fw-semibold">
                            Unit Code <span class="text-danger">*</span>
                        </label>
                    </div>

                    <div class="col-12 col-md-5">
                        <div class="cr-input">
                            <!-- ใช้ Choices.js -->
                            <select id="DDLUnitCode" class="form-control"></select>
                        </div>
                    </div>

                    <div class="col-auto">
                        <button id="crBtnSave" class="btn btn-success">
                            <i class="fa fa-check me-1"></i> Save
                        </button>
                    </div>
                </div>

                <!-- Table -->
                <div class="table-responsive">
                    <table class="table table-sm table-hover mb-0 cr-table" id="crTable">
                        <thead>
                            <tr>
                                <th>No.</th>
                                <th>Unit Code</th>
                                <th>Customer Name</th>
                                <th>Responsible Name</th>
                                <th>CSResponse Name</th>
                                <th>Status</th>
                                <th>Counter</th>
                                <th>Create By</th>
                                <th>Update Date</th>
                                <th>Update By</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>

            </div>

            <!-- Footer -->
            <div class="modal-footer justify-content-end">
                <button type="button" class="btn btn-light cr-cancel" data-bs-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>

<!-- Modal: Edit Register -->
<div id="EditRegisterLog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="hUnitCode" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        @* ใช้ modal-lg + centered *@
        <div class="modal-content modern-modal">

            <div class="modal-header border-0 pb-0">
                <div class="w-100 d-flex justify-content-between align-items-start">
                    <div>
                        <h5 class="modal-title fw-bold mb-1">
                            Edit Register Log
                        </h5>
                        <div class="text-muted small">
                            Unit: <span id="hUnitCode" class="fw-semibold"></span>
                        </div>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
            </div>

            <div class="modal-body pt-3 pb-1">
                <div class="edit-register-wrapper">

                    <!-- Block: Responsible & Career -->
                    <div class="er-section">
                        <h6 class="er-section-title">Customer Info</h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold small mb-1">Responsible<span class="text-danger">*</span></label>
                                <select id="ddl_Responsible" class="form-control" disabled>
                                    <option value="">-- Select Responsible --</option>
                                    @foreach (var cs in EditCSResponsList)
                                    {
                                        var val = (cs.ValueInt ?? "").ToString();
                                        var text = (cs.Text ?? "").ToString();
                                        <option value="@val">@text</option>
                                    }
                                </select>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-semibold small mb-1">Career<span class="text-danger">*</span></label>
                                <select id="ddl_Career" class="form-control">
                                    <option value="">-- Select Career --</option>
                                    @foreach (var cl in CareerList)
                                    {
                                        var val = (cl.ValueInt ?? "").ToString();
                                        var text = (cl.Text ?? "").ToString();
                                        <option value="@val">@text</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Block: Status -->
                    <div class="er-section">
                        <h6 class="er-section-title d-flex align-items-center">
                            Status
                            <span class="text-danger ms-1">*</span>
                        </h6>
                        <div class="er-status-group" role="group" aria-label="Status Group">
                            <button type="button"
                                    class="btn er-status-btn btn-success active"
                                    id="FlagRegister"
                                    disabled>
                                Register
                            </button>

                            <button type="button"
                                    class="btn er-status-btn btn-secondary"
                                    id="FlagInprocess">
                                In Process
                            </button>

                            <button type="button"
                                    class="btn er-status-btn btn-secondary"
                                    id="FlagFinish">
                                Done
                            </button>
                        </div>
                    </div>

                    <!-- Block: Reason & FinPlus -->
                    <div class="er-section">
                        <h6 class="er-section-title">Finance</h6>
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="row">
                                    <div class="col-md-12">
                                        <label class="form-label fw-semibold small mb-1">Reason<span class="text-danger">*</span></label>
                                        <select id="ddl_Reason" class="form-control">
                                            <option value="">-- Select Reason --</option>
                                            @foreach (var rl in ReasonList)
                                            {
                                                var val = (rl.ValueInt ?? "").ToString();
                                                var text = (rl.Text ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-md-12">
                                        <label class="form-label fw-semibold small mb-1">
                                            Non-Submission Reason <span class="text-danger">*</span>
                                        </label>
                                        <select id="ddl_BankNonSubmissionReason" class="form-control">
                                            <option value="">-- Select Non-Submission Reason --</option>
                                            @foreach (var bnsrl in BankNonSubmissionReasonList)
                                            {
                                                var val = (bnsrl.ValueInt ?? "").ToString();
                                                var text = (bnsrl.Text ?? "").ToString();
                                                <option value="@val">@text</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="row">
                                    <div class="col-md-12">
                                        <label class="form-label fw-semibold small mb-1">Fin Plus (Bank)</label>
                                        <div class="finplus-multi-bank" id="finplusBankList"></div>
                                    </div>
                                    <div class="col-md-12">
                                        <div id="Show_Submit_FinplusDate"></div>
                                    </div>
                                    <div class="col-md-12">
                                        <div id="finplusSubmitSlot"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Block: Contract -->
                    <div class="er-section" id="Show_Contract_Number">
                        <h6 class="er-section-title d-flex align-items-center">
                            Contract
                            <span class="text-danger ms-1">*</span>
                        </h6>

                        <div id="contractSlot"></div>
                    </div>

                </div>
            </div>

            <div class="modal-footer border-0 pt-0">
                <button type="button"
                        onclick="saveEditRegisterLog()"
                        class="btn btn-success px-4">
                    <i class="fa fa-save me-1" aria-hidden="true"></i> Save
                </button>
                <button type="button"
                        class="btn btn-outline-secondary"
                        data-bs-dismiss="modal">
                    Close
                </button>
            </div>

        </div>
    </div>
</div>

@section Scripts {
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script>
        const QueueBankCustomerViewUrl = '@Url.Action("Index", "QueueBankCustomerView")';
        const QueueBankCheckerViewUrl = '@Url.Action("Index", "QueueBankCheckerView")';
        const QueueBankCounterViewUrl = '@Url.Action("Index", "QueueBankCounterView")';
        window.CURRENT_LOGIN_ID = '@ViewBag.LoginID';
    </script>

    <script src="~/js/Pages/QueueBank/QueueBank.js?ver=@DateTime.Now.Ticks.ToString()"></script>
    <link rel="stylesheet" type="text/css" href="~/css/queuebank.css?ver=@DateTime.Now.Ticks.ToString()">

    <script src="~/js/jquery.signalR-2.4.2.js"></script>
    <script src="~/js/app-signalr.js?ver=@DateTime.Now.Ticks.ToString()"></script>
    <script type="text/javascript">
        var ChatServerUrl = "https://aswinno.assetwise.co.th/QCInspection/signalr/js";
        $(document).ready(function () {
            appSignalR.init();            
        });
    </script>
}

